### Overview: Investigating relationship between distance to closest enhancer, and concentration of enhancers within TAD regions, vs Gene regulation in dNipBL dataset represented by histogram/bar graphs.


1. Plotting cumulative distance to closest enhancer 

* while building flexible functions so that can add other, similar analyses:
 "cumulative distance plots to nearest ChIP peak"

For 1-day dNipBL dataset:
- add coordinates of TSS to each gene (flt.get_tss_gene_intervals())
- split by up/down/non-reg genes (flt.label_DE_status())
- Collect cumulative distances:
    - (pseudocode)
    for each set of enhancers (feature_interval):
        distances  = bioframe.closest(gene_coords, middle_of_enhancer_coords)
    - with above datastructure, plots:
    sort distances
    # line plot
    plot(cumulative_fraction(genes), sorted_distances)
    # histogram, too
    plt.hist(sorted_distances, binned)


2. How many dysregulated genes contain a distal enhancer in the same TAD?
â†’ bar plots, broken up by up/down/non, either as counts or %

Using the 1-day dNipBL dataset and mappings of closest enhancers:
- Use bonev boundaries to annotate "TAD-windows"
- Within each "TAD-window", count:
    - number of enhancers within the window (bioframe.overlap)
    - number of up-regulated, down-regulated, non-significant genes
    - percentage of up/down/non-sig genes
- plot: bar-graphs with number of enhancers/window on X-axis, category
of gene distribution on y-axis


=======
pseudocode:

# Counting and labeling the features that fall within a TAD:
def label_counts_within_window(window_df=tad_df, 
                                feature_df={feature_name : enhancers_df or feature_name2: gene_df}, 
                                aggregation={feature_name : None or agg_key(s)}, 
                                agg_category(s) = {feature_name: [categories]}

# Plotting grouped by number of Enhancers within the TAD:
# def plot_gene_enhancer_per_tad(tad_df, enhancer_col_name, count_cols={col_name: color, etc})



=======
Questions (add to issue in next commit)

1. insulation_boundaries -- start, end in range of 10,000.
    - assume: this is the bin for aggregating Hi-C signal
    - how to handle for plotting distances? take center?
        alt:
            - to left, right of boundary or ON boundary as a sep. category
    - for now, will just take center


2. for now, dropping all ChrX intervals --> upcoming/future work include these?

3. Do chromosomes interact with each other? Do people measure this?

4. Request review of functions/docs for num_TADs as x-axis vs distribution of genes as y-axis:
    - group_features_by_region() and distribution_features_by_region()
    - Tried to make these general, but I think it might be confusing to read
